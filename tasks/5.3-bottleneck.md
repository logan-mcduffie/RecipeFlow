# Task 5.3: Bottleneck Analysis

**Phase**: 5 - GregTech Calculations
**Status**: Not Started

## Summary

Identify which step in the chain limits overall throughput.

## Why This Matters

Helps users optimize their processing chains by showing exactly where production is limited.

## Inputs/Outputs

- **Input**: Complete flowchart with machine configs
- **Output**: Highlighted bottleneck node(s)

## Technical Notes

**Algorithm**:
1. Start from target (final output) node
2. Trace backwards through all connected nodes
3. At each step, calculate throughput based on config
4. Bottleneck = node with lowest throughput in path

**For branching chains**:
- Calculate bottleneck for each branch independently
- Overall bottleneck is minimum across all paths to target

**Visual indicators**:
- Bottleneck nodes get red/orange border or glow
- Icon badge showing "⚠ Bottleneck"
- Edges from bottleneck could be highlighted

**Summary panel**:
```
┌─────────────────────────────────────┐
│ Bottleneck Analysis                 │
├─────────────────────────────────────┤
│ Target: [icon] Steel Ingot          │
│ Current rate: 24/min                │
│                                     │
│ Limiting factor:                    │
│ ⚠ Electric Blast Furnace           │
│   Producing: 24/min                 │
│   Needed: 48/min                    │
│                                     │
│ Recommendation:                     │
│ Add 1 more parallel to match        │
│ downstream demand.                  │
└─────────────────────────────────────┘
```

**Recommendations**:
- "Add X parallels to node Y to match throughput"
- "Upgrade to [tier] to double speed"
- Shows how change would affect overall rate

## Files to Touch

- `packages/web/src/calculator/bottleneck.ts`
- `packages/web/src/editor/analysis/BottleneckOverlay.tsx`
- `packages/web/src/editor/panels/BottleneckPanel.tsx`

## Acceptance Criteria

- [ ] Correctly identifies bottleneck node(s)
- [ ] Visual highlight on limiting node
- [ ] Works with branching/merging chains
- [ ] Summary shows limiting factor
- [ ] Provides actionable recommendations
- [ ] Updates live when configs change
- [ ] Toggle to show/hide analysis overlay
