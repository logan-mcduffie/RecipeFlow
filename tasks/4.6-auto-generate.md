# Task 4.6: Auto-Generate Flowchart

**Phase**: 4 - Flowchart Editor Frontend
**Status**: Not Started

## Summary

Given a target item, automatically build the recipe chain.

## Why This Matters

Core feature - automatically traces back through all required crafting steps.

## Inputs/Outputs

- **Input**: Target item + quantity
- **Output**: Generated flowchart with all steps

## Technical Notes

**Generation dialog**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Generate Flowchart             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Target item:                   â”‚
â”‚ ğŸ” [Search for item...]        â”‚
â”‚                                â”‚
â”‚ Quantity: [64    ]             â”‚
â”‚                                â”‚
â”‚ Options:                       â”‚
â”‚ â˜‘ Include crafting recipes     â”‚
â”‚ â˜‘ Include GT machine recipes   â”‚
â”‚ â˜ Include tool crafting        â”‚
â”‚                                â”‚
â”‚ Max depth: [10 â–¼]              â”‚
â”‚                                â”‚
â”‚ [Cancel]          [Generate]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Algorithm (recursive)**:
1. Start with target item and quantity
2. Find recipe(s) that produce it
3. If multiple recipes, prompt user to choose (or use preferred)
4. For each input, recursively find recipes
5. Stop conditions:
   - Item is marked as "raw material"
   - Item has no recipes
   - Max depth reached
   - Cycle detected

**Quantity propagation**:
- If target is 64, calculate how many of each input needed
- Round up for fractional amounts
- Show "makes X, need Y" on nodes

**Layout algorithm**:
- Use dagre or similar for automatic positioning
- Flow from left (raw) to right (target)
- Group parallel branches vertically

**Cycle detection**:
- Some recipes loop (e.g., recycling)
- Detect and mark cycles, don't infinite loop

## Files to Touch

- `packages/web/src/editor/generation/generateFlowchart.ts`
- `packages/web/src/editor/generation/layoutFlowchart.ts`
- `packages/web/src/editor/dialogs/GenerateDialog.tsx`
- `packages/web/src/editor/dialogs/RecipeChoiceDialog.tsx`

## Acceptance Criteria

- [ ] Can generate from any craftable item
- [ ] Traces full recipe chain to raw materials
- [ ] Handles branching (multiple inputs)
- [ ] Quantity scaling works correctly
- [ ] Reasonable auto-layout (readable)
- [ ] User can choose between alternate recipes
- [ ] Cycle detection prevents infinite loops
- [ ] Respects max depth setting
