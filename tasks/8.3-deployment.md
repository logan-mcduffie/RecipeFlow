# Task 8.3: Deployment Configuration

**Phase**: 8 - Polish & Deployment
**Status**: Not Started

## Summary

Set up deployment for VPS hosting.

## Why This Matters

Need to run this on a VPS for others to access.

## Inputs/Outputs

- **Input**: Code, VPS access
- **Output**: Running production deployment

## Technical Notes

**Architecture**:
```
                    ┌─────────────────┐
                    │  Nginx/Caddy    │
                    │  (reverse proxy)│
    Internet ──────▶│  + SSL (Let's   │
                    │    Encrypt)     │
                    └────────┬────────┘
                             │
              ┌──────────────┴──────────────┐
              │                             │
              ▼                             ▼
    ┌─────────────────┐          ┌─────────────────┐
    │   Web (static)  │          │   API Server    │
    │   Port 3000     │          │   Port 4000     │
    └─────────────────┘          └────────┬────────┘
                                          │
                                          ▼
                                ┌─────────────────┐
                                │   PostgreSQL    │
                                │   Port 5432     │
                                └─────────────────┘
```

**Docker setup**:
- `Dockerfile.api` - Node.js API server
- `Dockerfile.web` - Nginx serving static React build
- `docker-compose.prod.yml` - orchestrates all services

**Environment configuration**:
- `.env.example` with all required vars
- Database URL, OAuth secrets, API keys
- Domain configuration

**Reverse proxy (Caddy preferred for simplicity)**:
```
recipeflow.example.com {
    handle /api/* {
        reverse_proxy api:4000
    }
    handle {
        reverse_proxy web:3000
    }
}
```

**Database**:
- Persistent volume for PostgreSQL data
- Backup script (pg_dump daily)

**Logging**:
- Structured JSON logs from API
- Log aggregation (optional: Loki, etc.)

**Health checks**:
- `/api/health` endpoint
- Docker health checks

## Files to Touch

- `docker-compose.prod.yml`
- `Dockerfile.api`
- `Dockerfile.web`
- `Caddyfile` or `nginx.conf`
- `.env.example`
- `scripts/backup.sh`

## Acceptance Criteria

- [ ] Docker images build successfully
- [ ] docker-compose brings up all services
- [ ] HTTPS works with valid certificate
- [ ] Database data persists across restarts
- [ ] API responds to health checks
- [ ] Logs are accessible
- [ ] Backup script works
- [ ] Environment variables documented
